#!/usr/bin/bash
export INCREMENTS=gene.increments.bed
export GENEBODIES=genebodies.tsv
export COUNTALL=countall.tsv

cat $GENEBODIES > $COUNTALL

function getCounts {
 R --no-save --args $INCREMENTS $COUNTFILE $BWPLUS $BWMINUS < getCounts.R
 bedmap --sum $GENEBODIES $COUNTFILE > $COUNTFILE.sum
 paste $COUNTALL $COUNTFILE.sum > tmp
 mv tmp $COUNTALL
 rm $COUNTFILE $COUNTFILE.sum
}


## Get counts, and place this in 'score'.
export COUNTFILE=J.count.bed
export BWPLUS=/usr/projects/GROseq/CD4/Alignments/J-U_plus.bw
export BWMINUS=/usr/projects/GROseq/CD4/Alignments/J-U_minus.bw
getCounts

export COUNTFILE=H1.count.bed
export BWPLUS=/usr/projects/GROseq/CD4/Alignments/CD4-U_plus.bw
export BWMINUS=/usr/projects/GROseq/CD4/Alignments/CD4-U_minus.bw
getCounts

export COUNTFILE=H3.count.bed
export BWPLUS=/usr/projects/GROseq/NHP/Alignments_1stPrep/H3-PI.bed.gz_plus.bw
export BWMINUS=/usr/projects/GROseq/NHP/Alignments_1stPrep/H3-PI.bed.gz_minus.bw
getCounts

export COUNTFILE=C3.count.bed
export BWPLUS=/usr/projects/GROseq/NHP/Alignments_2ndPrep/C3-U.bed.gz_plus.hg19.bw
export BWMINUS=/usr/projects/GROseq/NHP/Alignments_2ndPrep/C3-U.bed.gz_minus.hg19.bw
getCounts

export COUNTFILE=M1.count.bed
export BWPLUS=/usr/projects/GROseq/NHP/Alignments_1stPrep/M1-U.bed.gz_plus.hg19.bw
export BWMINUS=/usr/projects/GROseq/NHP/Alignments_1stPrep/M1-U.bed.gz_minus.hg19.bw
getCounts

export COUNTFILE=M2.count.bed
export BWPLUS=/usr/projects/GROseq/NHP/Alignments_2ndPrep/M2-PI.bed.gz_plus.hg19.bw
export BWMINUS=/usr/projects/GROseq/NHP/Alignments_2ndPrep/M2-PI.bed.gz_minus.hg19.bw
getCounts


